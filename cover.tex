% -*-latex-*-
%
% For questions, comments, concerns or complaints:
% thesis@mit.edu
%
%
% $Log: cover.tex,v $
% Revision 1.8  2008/05/13 15:02:15  jdreed
% Degree month is June, not May.  Added note about prevdegrees.
% Arthur Smith's title updated
%
% Revision 1.7  2001/02/08 18:53:16  boojum
% changed some \newpages to \cleardoublepages
%
% Revision 1.6  1999/10/21 14:49:31  boojum
% changed comment referring to documentstyle
%
% Revision 1.5  1999/10/21 14:39:04  boojum
% *** empty log message ***
%
% Revision 1.4  1997/04/18  17:54:10  othomas
% added page numbers on abstract and cover, and made 1 abstract
% page the default rather than 2.  (anne hunter tells me this
% is the new institute standard.)
%
% Revision 1.4  1997/04/18  17:54:10  othomas
% added page numbers on abstract and cover, and made 1 abstract
% page the default rather than 2.  (anne hunter tells me this
% is the new institute standard.)
%
% Revision 1.3  93/05/17  17:06:29  starflt
% Added acknowledgements section (suggested by tompalka)
%
% Revision 1.2  92/04/22  13:13:13  epeisach
% Fixes for 1991 course 6 requirements
% Phrase "and to grant others the right to do so" has been added to
% permission clause
% Second copy of abstract is not counted as separate pages so numbering works
% out
%
% Revision 1.1  92/04/22  13:08:20  epeisach

% NOTE:
% These templates make an effort to conform to the MIT Thesis specifications,
% however the specifications can change.  We recommend that you verify the
% layout of your title page with your thesis advisor and/or the MIT
% Libraries before printing your final copy.

% info in coverinfo.tex

% If there is more than one supervisor, use the \supervisor command
% once for each.
\supervisor{Adam Chlipala}{Associate Professor of Computer Science}

% Make the titlepage based on the above information.  If you need
% something special and can't use the standard form, you can specify
% the exact text of the titlepage yourself.  Put it in a titlepage
% environment and leave blank lines where you want vertical space.
% The spaces will be adjusted to fill the entire page.  The dotted
% lines for the signatures are made with the \signature command.
\maketitle

% The abstractpage environment sets up everything on the page except
% the text itself.  The title and other header material are put at the
% top of the page, and the supervisors are listed at the bottom.  A
% new page is begun both before and after.  Of course, an abstract may
% be more than one page itself.  If you need more control over the
% format of the page, you can use the abstract environment, which puts
% the word "Abstract" at the beginning and single spaces its text.

%% You can either \input (*not* \include) your abstract file, or you can put
%% the text of the abstract directly between the \begin{abstractpage} and
%% \end{abstractpage} commands.

% First copy: start a new page, and save the page number.
\cleardoublepage
% Uncomment the next line if you do NOT want a page number on your
% abstract and acknowledgments pages.
% \pagestyle{empty}
\setcounter{savepage}{\thepage}
\begin{abstractpage}
\input{abstract}
\end{abstractpage}

\makeatletter
\newwrite\@abstractpagefile
\immediate\openout\@abstractpagefile=abstract.endpage
\immediate\write\@abstractpagefile{\detokenize{\def\abstractendpage}{\the\numexpr\value{truepage}-1\relax}}
\makeatother

% Additional copy: start a new page, and reset the page number.  This way,
% the second copy of the abstract is not counted as separate pages.
% Uncomment the next 6 lines if you need two copies of the abstract
% page.
% \setcounter{page}{\thesavepage}
% \begin{abstractpage}
% \input{abstract}
% \end{abstractpage}

\cleardoublepage

%\section*{Dedication}
\pdfbookmark{Dedication}{dedication}
\minortodo{How do I format the dedication?}
\begin{center}
  \Large
  \emph{%
    Dedicated to future users and developers of proof assistants.%
  }

  \emph{%
    Dedicated also to my mom, for her perpetual support and nurturing throughout my life.%
  }
\end{center}
\minortodo{consider adding dedication page (to mom?) to others (too?)?}

\cleardoublepage

\section*{Acknowledgments}

\newcommand{\ackfirstcite}[1]{\citetitle{#1}~\cite{#1}}
\newcommand{\ackshortcite}[1]{\cite{#1}}
\newcommand{\acklongcite}[1]{\citetitle{#1}~\cite{#1}}

\minortodo{uniform style}
\minortodo{rearrange}
I'm extremely grateful to my advisor Adam Chlipala for his patience, guidance, encouragement, advice, and wisdom, during the writing of this dissertation, and through my research career.
I don't know what it's like to have any other PhD advisor, but I can't imagine having a PhD advisor who would have been better for my mental health than Adam.
I want to thank my coworkers, with special thanks to Andres Erbsen for many engaging conversations and rich and productive collaborations.
Special thanks to my mom, for taking every opportunity to enrich my life and setting me on this path, for encouraging me from my youth and always supporting me in all that I do.
I want to thank my sister Rachel, my dad, and the rest of my family for always being kind and supportive.
My friendship with Allison Strandberg through the years has been invaluable and fulfilling, and early discussions with her helped me shape the initial story I wanted to present with my dissertation.
I will be eternally grateful to Rajee Agrawal for her faith in me, for everything she's done to help me excel, for her help in finding a much better story for my work than I had ever had, and for helping me find how to present this story in both my defense and this dissertation.
While the technical work in proof assistants has always been a delight, writing papers has remained a struggle, and the process of completing my PhD with a thesis and a defense would have been a great deal more stressful without Rajee.

I want to thank the Coq development team---without whom I would not have a proof assistant to use---for their patience and responsiveness to my many, many bug reports, feature requests, and questions.
Special thanks to Pierre-Marie Pédrot for doing the heavy lifting of tracking down performance issues inside Coq and explaining them to me, and fixing many of them.
I'd also like to thank Matthieu Sozeau for adding support for universe polymorphism and primitive projections to Coq, and responding to all of my bug reports on the functionality and performance of these features from my work on the HoTT Category Theory library during the development of these features.

I'd like to thank the rest of my thesis committee---Professor Saman Amarasinghe and Professor Nickolai Zeldovich---for their support and direction during the editing of this dissertation and my defense.

Moving on to more specific acknowledgments, I want to thank Andres Erbsen for pointing out to me some of the particular performance bottlenecks in Coq that I made use of in this thesis, including those of subsubsection \nameref{sec:sharing} in \autoref{sec:sharing} and those of subsections \nameref{sec:name-resolution}, \nameref{sec:perf:capture-avoiding-subst}, \nameref{sec:perf:quadratic-evar-subst}, and \nameref{sec:perf:quadratic-application} in \autoref{sec:perf:binder-count}.
I'd like to thank András Kovács for a brief exchange with me and Andres in which it became clear that we could frame many of the performance issues we were encountering as needing to ``get the basics right.''

I'd like to thank Hugo Herbelin for sharing the trick with \texttt{type of} to propagate universe constraints%
\footnote{%
    \url{https://github.com/coq/coq/issues/5996\#issuecomment-338405694}%
}
as well as useful conversations on Coq's bug tracker that allowed us to track down performance issues.%
\footnote{%
    \url{https://github.com/coq/coq/issues/6252}%
}
I would like to thank Jonathan Leivent for sharing the trick of annotating identifiers with \texttt{: Type} to avoid needing to adjust universes%
\footnote{%
  \url{https://github.com/coq/coq/issues/5996\#issuecomment-670955273}
}%
.
I would like to thank Pierre-Marie Pédrot for conversations on Coq's Gitter and his help in tracking down performance bottlenecks in earlier versions of our reification scripts and in Coq's tactics.
I would like to thank Beta Ziliani for his help in using Mtac2, as well as his invaluable guidance in figuring out how to use canonical structures to reify to PHOAS.
I also thank John Wiegley for feedback on \ackfirstcite{reification-by-parametricity}, which is included in slightly-modified form distributed between \autoref{ch:reification-by-parametricity} and various sections of \autoref{ch:reflection}.
% \todo{Figure out if anyone else needs mentioning}

I'd like to thank Karl Palmskog for pointing me at \textcite{Should1999Lamport} and \textcite{Formalising2018Paulson}.%
\footnote{@palmskog on gitter \url{https://gitter.im/coq/coq?at=5e5ec0ae4eefc06dcf31943f}}


\minortodo{rearrange}
\minortodo{make sure we didn't miss anything}
I'd like to thank Rajee Agrawal for her help in structuring, wording, and copy-editing of this document.

I'd like to thank Karl Palmskog, Talia Ringer, Ilya Sergey, and Zachary Tatlock for making the high-quality \LaTeX\space bibliography file for \ackfirstcite{ringer2020qed} available on GitHub\footnote{\url{https://github.com/proofengineering/proofengineering-bib/blob/master/proof-engineering.bib}} and pointing me at it; it's been quite useful in polishing the bibliography of this document.

A significant fraction of the text of this dissertation is taken from papers I've co-authored during my PhD, sometimes with major edits, other times with only minor edits to conform to the flow of the dissertation.

In particular:
\minortodo{how to format citations here}

\Autoref{ch:rewriting} is largely taken from a draft paper co-authored with Andres Erbsen and Adam Chlipala.
\minortodo{actually cite rewriting}

\Autoref{sec:reification-by-parametricity:intro,sec:reif-survey} are based on the introduction to \ackfirstcite{reification-by-parametricity}.
\Autoref{ch:reification-by-parametricity} is largely taken from \ackshortcite{reification-by-parametricity}, with some new text for this dissertation.

\Autoref{ch:api-design} is based largely on \ackfirstcite{category-coq-experience}, and I'd like to thank Benedikt Ahrens, Daniel R.~Grayson, Robert Harper, Bas Spitters, and Edward Z.~Yang for feedback on this paper.
\Autoref{sec:category-theory-library,sec:duality-conversion%,sec:associators
  %,sec:equality-reflection
  ,sec:abstraction:(co)limits,sec:term-size} are largely taken from \ackshortcite{category-coq-experience}.
Some of the text in \Autoref{sec:univ-poly,sec:HITs} also comes from \ackshortcite{category-coq-experience}.

\minortodo{do we need/want to mention this?  how to cite it?}

For those interested in history, our method of reification by parametricity presented in \autoref{ch:reification-by-parametricity} was inspired by the \texttt{evm\_compute} tactic~\cite{MirrorShardITP14}.
We first made use of \texttt{pattern} to allow \texttt{vm\_compute} to replace \texttt{cbv}-with-an-explicit-blacklist when we discovered \texttt{cbv} was too slow and the blacklist too hard to maintain.
We then noticed that in the sequence of doing abstraction; \texttt{vm\_compute}; application; $\beta$-reduction; reification, we could move $\beta$-reduction to the end of the sequence if we fused reification with application, and thus reification by parametricity was born.

This work was supported in part by a Google Research Award and National Science Foundation grants CCF-1253229, CCF-1512611, and CCF-1521584.
Work on the category-theory library, one of the case studies presented in \autoref{ch:api-design} and presented more fully in \ackshortcite{category-coq-experience}, was supported in part by the MIT bigdata@CSAIL initiative, NSF grant CCF-1253229, ONR grant N000141310260, and AFOSR grant FA9550-14-1-0031.
This material is also based upon work supported by the National Science Foundation Graduate Research Fellowship under Grant No.\ \todo{get NSF GRFP grant number}.
Any opinion, findings, and conclusions or recommendations expressed in this material are those of the authors(s) and do not necessarily reflect the views of the National Science Foundation.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% -*-latex-*-
