% File for misc fragments that might go back in thesis proposal somewhere
\documentclass{article}
\begin{document}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
Broadly, there are five sorts of things that result in slowness in Coq, all of which fall under the heading of Coq ``doing too much stuff.''
\begin{itemize}
\item
  Sometimes we end up accidentally having Coq do the same things repeatedly (e.g., repeatedly typechecking the same term which may show up as an argument to many constructors)
\item
  Sometimes we end up having Coq compute something when we didn't have to (e.g., eagerly evaluating recursive calls even when their results are never used)
\item
  Sometimes there's overhead from using one portion of Coq rather than a different one (e.g., using \texttt{cbv} rather than \texttt{vm\_compute}, using \texttt{Ltac} rather than \texttt{Gallina} or \texttt{OCaml})
\item
  Sometimes there's an algorithmic inefficiency in the Ltac or Gallina code being computed (e.g., using unary \texttt{nat}s rather than binary \texttt{N}s for comparing large natural numbers (such as 256))
\item
  Sometimes there's an inefficiency in the Coq codebase itself (e.g., many of the bugs fixed by Pierre-Marie PÃ©drot tagged with ``performance'')
\end{itemize}

Most of the bottlenecks fall into type checking, term building, unification, or normalization, but there are a couple of other notable categories.
In proofs with large contexts many steps which modify the goal, management of the contexts of existential variables can become a bottleneck; it's not clear to me how much of this is specific to Coq and how much of this shows up in other designs of proof assistants.
In some parts of the Coq system, context management more generally when under many binders can be a bottleneck.
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\end{document}
