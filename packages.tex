\usepackage{iftex}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{amsthm}
% order matters, see https://tex.stackexchange.com/a/83051/2066
\usepackage{varioref}
\usepackage{hyperref}
\usepackage[nameinlink]{cleveref}
\usepackage{eforms}
\usepackage{xargs}
\usepackage{soul}
\usepackage{tikz}
\usepackage{pgf}
\usepackage{pgfplots}
\usepackage{gnuplottex}[2016/08/21]%must be before listings package; min date is for compat with tikzexternalize
\usepackage{pgfkeys}
\usepackage{pgffor}
\usepackage{pgfplotstable}
\pgfplotsset{compat=1.15}
\usepackage{unicode-math}
\usepackage{calc}
\usepackage{letltxmacro}
\usepackage{ifthen}
\usepackage{xifthen}
\usepackage{appendix}
\usepackage{minted}
\usepackage{currfile}
\usepackage{xparse}
\usepackage{xcolor}
\usepackage{xstring}
\usepackage[color]{coqdoc}
\hypersetup{raiselinks=false,colorlinks=false,linkcolor=black} % undo coqdoc stuff
\usepackage{bussproofs}
%\usepackage{ebproof}
\usepackage{graphicx}
\usepackage{listings}
\usepackage{marvosym}
\usepackage{mathtools}
\usepackage{bcprules}
\usepackage{multicol}
\usepackage{apptools}
\usepackage{adjustbox}
%\usepackage[utf8x]{inputenc}
\usepackage{booktabs}   %% For formal tables:
%% http://ctan.org/pkg/booktabs
\usepackage{float}
\usepackage{wrapfig}
\setlength{\intextsep}{0pt} % don't add space above nor below
%\usepackage{subcaption} %% For complex figures with subfigures/subcaptions
\usepackage{subfig}
\newcommand{\subfigureautorefname}{\figureautorefname}
%\usepackage{microtype}
\usepackage{textcomp}
\usepackage{attachfile2}
\usepackage{etoolbox}
\usepackage{everypage}
\usepackage{xpatch}
\usepackage[
  maxbibnames=999,
  backend=biber,
  citestyle=authoryear,
  style=alphabetic
]{biblatex}% backend=bibtex,
%\usepackage{embedfile}
%\usepackage{hypgotoe}
\floatstyle{boxed}
\restylefloat{figure}
\usepackage{verbatim}
\usepackage{upquote}
\usepackage{enumerate}
\usepackage{cleveref}
\usepackage[all,cmtip]{xy}
\usepackage{stmaryrd}
\usepackage{morefloats}
%\usepackage[autogenerated,mathletters]{ucs}
%Package inputenc Warning: inputenc package ignored with utf8 based engines.
\ifLuaTeX
\else
\usepackage[utf8]{inputenc}
\fi
\usepackage{textgreek}

\makeatletter
\newcommand{\ensuretext}[1]{%
    \ifmmode
    \expandafter\@firstoftwo
    \else
    \expandafter\@secondoftwo
    \fi
    {\text{#1}}%
    {#1}%
}
\newcommand{\ensuretexttt}[1]{\ensuretext{\texttt{#1}}}
\makeatother

\usepackage{newunicodechar}
\newcommand{\newunicodecharpdftex}[2]{\newunicodechar{#1}{\texorpdfstring{#2}{#1}}}
\newunicodecharpdftex{Œë}{\ensuremath{\Alpha}}
\newunicodecharpdftex{Œí}{\ensuremath{\Beta}}
\newunicodecharpdftex{Œì}{\ensuremath{\Gamma}}
\newunicodecharpdftex{Œî}{\ensuremath{\Delta}}
\newunicodecharpdftex{Œï}{\ensuremath{\Epsilon}}
\newunicodecharpdftex{Œñ}{\ensuremath{\Zeta}}
\newunicodecharpdftex{Œó}{\ensuremath{\Eta}}
\newunicodecharpdftex{Œò}{\ensuremath{\Theta}}
\newunicodecharpdftex{Œô}{\ensuremath{\Iota}}
\newunicodecharpdftex{Œö}{\ensuremath{\Kappa}}
\newunicodecharpdftex{Œõ}{\ensuremath{\Lambda}}
\newunicodecharpdftex{Œú}{\ensuremath{\Mu}}
\newunicodecharpdftex{Œù}{\ensuremath{\Nu}}
\newunicodecharpdftex{Œû}{\ensuremath{\Xi}}
\newunicodecharpdftex{Œü}{\ensuremath{\Omicron}}
\newunicodecharpdftex{Œ†}{\ensuremath{\Pi}}
\newunicodecharpdftex{Œ°}{\ensuremath{\Rho}}
\newunicodecharpdftex{Œ£}{\ensuremath{\Sigma}}
\newunicodecharpdftex{Œ§}{\ensuremath{\Tau}}
\newunicodecharpdftex{Œ•}{\ensuremath{\Upsilon}}
\newunicodecharpdftex{Œ¶}{\ensuremath{\Phi}}
\newunicodecharpdftex{Œß}{\ensuremath{\Chi}}
\newunicodecharpdftex{Œ®}{\ensuremath{\Psi}}
\newunicodecharpdftex{Œ©}{\ensuremath{\Omega}}
\newunicodecharpdftex{Œ±}{\ensuremath{\alpha}}
\newunicodecharpdftex{Œ≤}{\ensuremath{\beta}}
\newunicodecharpdftex{Œ≥}{\ensuremath{\gamma}}
\newunicodecharpdftex{Œ¥}{\ensuremath{\delta}}
\newunicodecharpdftex{œµ}{\ensuremath{\epsilon}}
\newunicodecharpdftex{Œµ}{\ensuremath{\varepsilon}}
\newunicodecharpdftex{Œ∂}{\ensuremath{\zeta}}
\newunicodecharpdftex{Œ∑}{\ensuremath{\eta}}
\newunicodecharpdftex{Œ∏}{\ensuremath{\theta}}
\newunicodecharpdftex{œë}{\ensuremath{\vartheta}}
\newunicodecharpdftex{Œπ}{\ensuremath{\iota}}
\newunicodecharpdftex{Œ∫}{\ensuremath{\kappa}}
\newunicodecharpdftex{œ∞}{\ensuremath{\varkappa}}
\newunicodecharpdftex{Œª}{\ensuremath{\lambda}}
\newunicodecharpdftex{Œº}{\ensuremath{\mu}}
\newunicodecharpdftex{ŒΩ}{\ensuremath{\nu}}
\newunicodecharpdftex{Œæ}{\ensuremath{\xi}}
\newunicodecharpdftex{Œø}{\ensuremath{\omicron}}
\newunicodecharpdftex{œÄ}{\ensuremath{\pi}}
\newunicodecharpdftex{œñ}{\ensuremath{\varpi}}
\newunicodecharpdftex{œÅ}{\ensuremath{\rho}}
\newunicodecharpdftex{œ±}{\ensuremath{\varrho}}
\newunicodecharpdftex{œÉ}{\ensuremath{\sigma}}
\newunicodecharpdftex{œÇ}{\ensuremath{\varsigma}}
\newunicodecharpdftex{œÑ}{\ensuremath{\tau}}
\newunicodecharpdftex{œÖ}{\ensuremath{\upsilon}}
\newunicodecharpdftex{œï}{\ensuremath{\phi}}
\newunicodecharpdftex{œÜ}{\ensuremath{\varphi}}
\newunicodecharpdftex{œá}{\ensuremath{\chi}}
\newunicodecharpdftex{œà}{\ensuremath{\psi}}
\newunicodecharpdftex{œâ}{\ensuremath{\omega}}
\newunicodecharpdftex{‚àÄ}{\ensuremath{\forall}}
\newunicodecharpdftex{‚àÉ}{\ensuremath{\exists}}
\newunicodecharpdftex{‚Üí}{\ensuremath{\to}}
\newunicodecharpdftex{‚áí}{\ensuremath{\Rightarrow}}
\newunicodecharpdftex{‚Üî}{\ensuremath{\leftrightarrow}}
\newunicodecharpdftex{‚áî}{\ensuremath{\Leftrightarrow}}
\newunicodecharpdftex{√ó}{\ensuremath{\times}}
\newunicodecharpdftex{‚àß}{\ensuremath{\wedge}}
\newunicodecharpdftex{‚ä¢}{\ensuremath{\vdash}}
\newunicodecharpdftex{ùîπ}{\ensuremath{\mathbb{B}}}
\newunicodecharpdftex{‚ÑÇ}{\ensuremath{\mathbb{C}}}
\newunicodecharpdftex{‚Ñï}{\ensuremath{\mathbb{N}}}
\newunicodecharpdftex{‚Ñô}{\ensuremath{\mathbb{P}}}
\newunicodecharpdftex{‚Ñö}{\ensuremath{\mathbb{Q}}}
\newunicodecharpdftex{‚Ñù}{\ensuremath{\mathbb{R}}}
\newunicodecharpdftex{‚Ñ§}{\ensuremath{\mathbb{Z}}}
\newunicodecharpdftex{¬∑}{\ensuremath{\cdot}}
\newunicodecharpdftex{‚Ü¶}{\ensuremath{\mapsto}}
\newunicodecharpdftex{‚àà}{\ensuremath{\in}}
\newunicodecharpdftex{‚ü®}{\ensuremath{\langle}}
\newunicodecharpdftex{‚ü©}{\ensuremath{\rangle}}
\newunicodecharpdftex{·¥è}{\textsc{o}}
\newunicodecharpdftex{·¥ò}{\textsc{p}}
\newunicodecharpdftex{…™}{\textsc{i}}

\newcommand{\aswidthof}[2]{\rlap{#1}\hphantom{#2}}

\newboolean{zerowidthscripts}
\newboolean{fullwidthscripts}
\newcommand{\mathsubsup}[2]{%
\ifthenelse{\boolean{zerowidthscripts}}{%
  \aswidthof{\ensuremath{{}#1{#2}}}{}%
}{\ifthenelse{\boolean{fullwidthscripts}}{%
  \aswidthof{\ensuremath{{}#1{#2}}}{\ensuremath{#2}}%
}{%
  \ensuremath{{}#1{#2}}%
}}}
\newcommand{\mathtextsubsup}[2]{\mathsubsup{#1}{\text{#2}}}

\newunicodecharpdftex{‚Å∞}{\mathsubsup^0}
\newunicodecharpdftex{¬π}{\mathsubsup^1}
\newunicodecharpdftex{¬≤}{\mathsubsup^2}
\newunicodecharpdftex{¬≥}{\mathsubsup^3}
\newunicodecharpdftex{‚Å¥}{\mathsubsup^4}
\newunicodecharpdftex{‚Åµ}{\mathsubsup^5}
\newunicodecharpdftex{‚Å∂}{\mathsubsup^6}
\newunicodecharpdftex{‚Å∑}{\mathsubsup^7}
\newunicodecharpdftex{‚Å∏}{\mathsubsup^8}
\newunicodecharpdftex{‚Åπ}{\mathsubsup^9}
\newunicodecharpdftex{‚ÇÄ}{\mathsubsup_0}
\newunicodecharpdftex{‚ÇÅ}{\mathsubsup_1}
\newunicodecharpdftex{‚ÇÇ}{\mathsubsup_2}
\newunicodecharpdftex{‚ÇÉ}{\mathsubsup_3}
\newunicodecharpdftex{‚ÇÑ}{\mathsubsup_4}
\newunicodecharpdftex{‚ÇÖ}{\mathsubsup_5}
\newunicodecharpdftex{‚ÇÜ}{\mathsubsup_6}
\newunicodecharpdftex{‚Çá}{\mathsubsup_7}
\newunicodecharpdftex{‚Çà}{\mathsubsup_8}
\newunicodecharpdftex{‚Çâ}{\mathsubsup_9}
\newunicodecharpdftex{‚Å∫}{\mathsubsup^+}
\newunicodecharpdftex{‚Åª}{\mathsubsup^-}
\newunicodecharpdftex{‚Åº}{\mathsubsup^=}
\newunicodecharpdftex{‚ÅΩ}{\mathsubsup^(}
\newunicodecharpdftex{‚Åæ}{\mathsubsup^)}
\newunicodecharpdftex{‚Çä}{\mathsubsup_+}
\newunicodecharpdftex{‚Çã}{\mathsubsup_-}
\newunicodecharpdftex{‚Çå}{\mathsubsup_=}
\newunicodecharpdftex{‚Çç}{\mathsubsup_(}
\newunicodecharpdftex{‚Çé}{\mathsubsup_)}

\newunicodecharpdftex{·µÉ}{\mathtextsubsup^{a}}
\newunicodecharpdftex{·µá}{\mathtextsubsup^{b}}
\newunicodecharpdftex{·∂ú}{\mathtextsubsup^{c}}
\newunicodecharpdftex{·µà}{\mathtextsubsup^{d}}
\newunicodecharpdftex{·µâ}{\mathtextsubsup^{e}}
\newunicodecharpdftex{·∂†}{\mathtextsubsup^{f}}
\newunicodecharpdftex{·µç}{\mathtextsubsup^{g}}
\newunicodecharpdftex{ ∞}{\mathtextsubsup^{h}}
\newunicodecharpdftex{‚Å±}{\mathtextsubsup^{i}}
\newunicodecharpdftex{ ≤}{\mathtextsubsup^{j}}
\newunicodecharpdftex{·µè}{\mathtextsubsup^{k}}
\newunicodecharpdftex{À°}{\mathtextsubsup^{l}}
\newunicodecharpdftex{·µê}{\mathtextsubsup^{m}}
\newunicodecharpdftex{‚Åø}{\mathtextsubsup^{n}}
\newunicodecharpdftex{·µí}{\mathtextsubsup^{o}}
\newunicodecharpdftex{·µñ}{\mathtextsubsup^{p}}
\newunicodecharpdftex{ ≥}{\mathtextsubsup^{r}}
\newunicodecharpdftex{À¢}{\mathtextsubsup^{s}}
\newunicodecharpdftex{·µó}{\mathtextsubsup^{t}}
\newunicodecharpdftex{·µò}{\mathtextsubsup^{u}}
\newunicodecharpdftex{·µõ}{\mathtextsubsup^{v}}
\newunicodecharpdftex{ ∑}{\mathtextsubsup^{w}}
\newunicodecharpdftex{À£}{\mathtextsubsup^{x}}
\newunicodecharpdftex{ ∏}{\mathtextsubsup^{y}}
\newunicodecharpdftex{·∂ª}{\mathtextsubsup^{z}}
\newunicodecharpdftex{‚Çê}{\mathtextsubsup_{a}}
\newunicodecharpdftex{‚Çë}{\mathtextsubsup_{e}}
\newunicodecharpdftex{‚Çï}{\mathtextsubsup_{h}}
\newunicodecharpdftex{·µ¢}{\mathtextsubsup_{i}}
\newunicodecharpdftex{‚±º}{\mathtextsubsup_{j}}
\newunicodecharpdftex{‚Çñ}{\mathtextsubsup_{k}}
\newunicodecharpdftex{‚Çó}{\mathtextsubsup_{l}}
\newunicodecharpdftex{‚Çò}{\mathtextsubsup_{m}}
\newunicodecharpdftex{‚Çô}{\mathtextsubsup_{n}}
\newunicodecharpdftex{‚Çí}{\mathtextsubsup_{o}}
\newunicodecharpdftex{‚Çö}{\mathtextsubsup_{p}}
\newunicodecharpdftex{·µ£}{\mathtextsubsup_{r}}
\newunicodecharpdftex{‚Çõ}{\mathtextsubsup_{s}}
\newunicodecharpdftex{‚Çú}{\mathtextsubsup_{t}}
\newunicodecharpdftex{·µ§}{\mathtextsubsup_{u}}
\newunicodecharpdftex{·µ•}{\mathtextsubsup_{v}}
\newunicodecharpdftex{‚Çì}{\mathtextsubsup_{x}}

\newunicodecharpdftex{‚âÖ}{\ensuremath{\cong}}
\newunicodecharpdftex{‚àò}{\ensuremath{\circ}}
\newunicodecharpdftex{‚Ä¶}{\ldots}
\newunicodecharpdftex{‚ãØ}{\cdots}
\newunicodecharpdftex{‚ãÆ}{\vdots}
\todo{fix vdots character as per https://tex.stackexchange.com/questions/577469/how-can-i-use-vdots-in-the-presence-of-unicode-math}
\newunicodecharpdftex{‚âî}{\coloneq}

\usepgfplotslibrary{units}
\usepgfplotslibrary{external}
\tikzexternalize
\def\basefigurename{jgross-thesis}%or \tikzexternalrealjob, which will result in more overhead
\tikzsetfigurename{\basefigurename-\currfilebase-figure}

\newcounter{truepage}
\setcounter{truepage}{1}
\AddEverypageHook{\stepcounter{truepage}}

% Minted red box around greek characters - https://tex.stackexchange.com/a/343506/2066
\usemintedstyle{bw}
\setmintedinline{breaklines}
\makeatletter
\def\dontdofcolorbox{\renewcommand\fcolorbox[4][]{##4}}
\newcommand{\@mintedextraoptions}{\dontdofcolorbox\setboolean{fullwidthscripts}{true}}
\AtBeginEnvironment{minted}{\@mintedextraoptions}
\xpatchcmd{\inputminted}{\minted@fvset}{\minted@fvset\@mintedextraoptions}{}{}
\xpatchcmd{\mintinline}{\minted@fvset}{\minted@fvset\@mintedextraoptions}{}{}
% Work around bug(https://github.com/gpoore/minted/issues/273)
% Considered https://tex.stackexchange.com/questions/127010/how-can-i-make-lstinline-function-normally-inside-math-mode, but it doesn't work
\let\oldmintinline=\mintinline
\newcommand{\textmintinline}[3][]{\text{\oldmintinline[#1]{#2}{#3}}}
\def\mintinline{\relax\ifmmode\expandafter\textmintinline\else\expandafter\oldmintinline\fi}
\makeatother
% kludge to eliminate top spacing in minted
\def\FancyVerbVspace{0pt}

\renewcommand{\chapterautorefname}{Chapter}
\renewcommand{\sectionautorefname}{Section}
\renewcommand{\subsectionautorefname}{Subsection}
\renewcommand{\subsubsectionautorefname}{Subsubsection}
\newcommand{\appendixautoref}[1]{\bgroup
\def\chapterautorefname{Appendix}%
\def\sectionautorefname{Appendix}%
\def\subsectionautorefname{Appendix}%
\def\subsubsectionautorefname{Appendix}%
\newcommand{\subfigureautorefname}{\figureautorefname}
\autoref{#1}%
\egroup}

%{\catcode`\_=12 \gdef\textunderscore{_}}
%\def\_{\textunderscore}

% from http://tex.stackexchange.com/a/218441/2066
\makeatletter
\newcommand{\dashover}[2][\mathop]{#1{\mathpalette\df@over{{\dashfill}{#2}}}}
\newcommand{\fillover}[2][\mathop]{#1{\mathpalette\df@over{{\solidfill}{#2}}}}
\newcommand{\df@over}[2]{\df@@over#1#2}
\newcommand\df@@over[3]{%
  \vbox{
    \offinterlineskip
    \ialign{##\cr
      #2{#1}\cr
      \noalign{\kern1pt}
      $\m@th#1#3$\cr
    }
  }%
}
\newcommand{\dashfill}[1]{%
  \kern-.5pt
  \xleaders\hbox{\kern.5pt\vrule height.4pt width \dash@width{#1}\kern.5pt}\hfill
  \kern-.5pt
}
\newcommand{\dash@width}[1]{%
  \ifx#1\displaystyle
    2pt
  \else
    \ifx#1\textstyle
      1.5pt
    \else
      \ifx#1\scriptstyle
        1.25pt
      \else
        \ifx#1\scriptscriptstyle
          1pt
        \fi
      \fi
    \fi
  \fi
}
\newcommand{\solidfill}[1]{\leaders\hrule\hfill}
\makeatother

\AtEndDocument{\minortodo{better format for coqbug and coqpr?}}
\newcommand{\coqbug}[2][Coq bug ]{\href{https://github.com/coq/coq/issues/#2}{#1\##2}}
\newcommand{\coqpr}[2][Coq PR ]{\href{https://github.com/coq/coq/issues/#2}{#1\##2}}
\newcommand{\coqissue}[2][Coq issue ]{\href{https://github.com/coq/coq/issues/#2}{#1\##2}}
\newcommand{\ocamlbug}[2][OCaml bug ]{\href{https://github.com/ocaml/ocmal/issues/#2}{#1\##2}}
\newcommand{\kw}[1]{{\fontfamily{pcr}\selectfont\textbf{#1}}}
\newcommand{\tactic}[1]{\texttt{#1}}
\newcommand{\finishingtactic}[1]{\tactic{#1}}
\newcommand{\tacREFLEXIVITY}{\finishingtactic{reflexivity}}
\newcommand{\strcolored}[1]{\texttt{\textcolor{DarkGreen}{#1}}}
\newcommand{\stropen}{\texttt{"}}
\newcommand{\strclose}{\texttt{"}}
\newcommand{\str}[1]{\stropen\strcolored{#1}\strclose}
\newcommand{\regex}[1]{\texttt{#1}}
\newcommand{\nt}[1]{\texttt{#1}}
\newcommand{\terminal}[1]{\texttt{\textquotesingle\textcolor{DarkGreen}{#1}\textquotesingle}}
\newcommand{\production}[1]{[#1]}
\newcommand{\productions}[1]{#1}
\newcommand{\coqtype}[1]{\texttt{#1}}
\newcommand{\False}{\ensuremath{\bot}}
\newcommand{\True}{\ensuremath{\top}}
\newcommand{\Unit}{\ensuremath{\top}}
\newcommand{\true}{\texttt{true}}
\newcommand{\false}{\texttt{false}}
\newcommand{\unittt}{\texttt{()}}
\newcommand{\String}{\texttt{String}}
\newcommand{\Bool}{\texttt{Bool}}
\newcommand{\nat}{\ensuremath{\mathbb{N}}}
\newcommand{\textnbsp}{\ifmmode\else~\fi}
\newcommand{\typeprodsep}{\ensuremath{\times}}
\newcommand{\typeprod}[2]{#1\textnbsp\typeprodsep\textnbsp#2}
\newcommand{\typesumsep}{\ensuremath{+}}
\newcommand{\typesum}[2]{#1\textnbsp\typesumsep\textnbsp#2}
\newcommand{\fname}[1]{\texttt{#1}}
\newcommand{\farg}[1]{\textcolor{violet}{\texttt{#1}}}
\newcommand{\oftypesep}{:}
\newcommand{\oftype}[2]{#1\textnbsp\oftypesep\textnbsp#2}
\newcommand{\nil}{\texttt{[]}}
\newcommand{\cons}[2]{#1::#2}
%\newcommand{\hole}{\texttt{\_}}
\newcommand{\termhole}{\texttt{\_}}
\newcommand{\defeq}{\coloneqq}
\newcommand{\testeq}{=}
\newcommand{\booland}{\mathrel{\texttt{\&\&}}}
\newcommand{\boolor}{\mathrel{\texttt{||}}}
\newcommand{\letinlet}{\kw{let}~}
\newcommand{\letinkw}[1]{\letinlet#1~\kw{in}}
\newcommand{\strcat}[2]{#1#2}
\newcommand{\llstrcat}[2]{#1 \ensuremath{\cdot} #2}
\newcommand{\afun}[2]{\ensuremath{\lambda~#1.~#2}}
\newcommand{\typeto}{\ensuremath{\to}}
\newcommand{\indname}[1]{\texttt{#1}}
\newcommand{\Cat}{\kw{Cat}}
\newcommand{\Type}{\kw{Type}}
\newcommand{\Set}{\kw{Set}}
\newcommand{\Prop}{\kw{Prop}}
\newcommand{\constructorname}[1]{\texttt{#1}}
\newcommand{\Nonterminal}{\indname{Nonterminal}}
\newcommand{\Terminal}{\texttt{Char}}
\newcommand{\parsetreetype}[2]{\ensuremath{\dashover[]{#2 \in #1}}}
\newcommand{\minparsetreeannot}[2]{\ensuremath{<(#1,#2)}}
\newcommand{\minparsetreetype}[4]{\ensuremath{\dashover[]{#4 \in #3}^{~\minparsetreeannot{#1}{#2}}}}
\newcommand{\typelist}[1]{\texttt{[}#1\texttt{]}}
\newcommand{\typelistp}[1]{\typelist{#1}} % parenthesized \typelist, if need be (so, `list (foo)` instead of `list foo`)
\newcommand{\valuelist}[1]{\texttt{[}#1\texttt{]}}
\newcommand{\valuelistm}[1]{\ensuremath{\big[#1\big]}} % math mode
\newcommand{\typeoption}[2][~~]{\indname{option}#1#2}
\newcommand{\typeoptionp}[1]{\typeoption[~]{(#1)}} % parenthesized \typeoption, if need be
\newcommand{\None}{\constructorname{None}}
\newcommand{\Some}[1]{\constructorname{Some}~#1}
\newcommand{\Somep}[1]{\constructorname{Some}~(#1)}
\newcommand{\ParseQuery}{\indname{ParseQuery}}
\newcommand{\inl}[1]{\constructorname{inl}~#1}
\newcommand{\inlp}[1]{\inl{(#1)}}
\newcommand{\inr}[1]{\constructorname{inr}~#1}
\newcommand{\inrp}[1]{\inr{(#1)}}
\newcommand{\fst}[1]{\texttt{fst}~#1}
\newcommand{\snd}[1]{\texttt{snd}~#1}
\newcommand{\proj}[2]{#2\ensuremath{_{\kw{#1}}}}
\newcommand{\precaseof}{\kw{case}~~~}
\newcommand{\caseof}[1]{\precaseof#1~~~\kw{of}}
\newcommand{\acase}[3][\big]{~#1|{~{#2}~~\ensuremath{\to}~~{#3}}}
\newcommand{\cif}{\kw{if}~~~}
\newcommand{\cifindent}[1][]{\aswidthof{#1}{\kw{then}}~~~}
\newcommand{\cthen}{\cifindent[\kw{then}]}
\newcommand{\celse}{\cifindent[\kw{else}]}
\newcommand{\cancomputeto}[2]{#1~~\ensuremath{\rightsquigarrow}~~#2}
\newcommand{\Rtac}{\texorpdfstring{\ensuremath{\mathcal{R}_{\text{\textit{tac}}}}}{Rtac}}
\newcommand{\Ltac}{\texorpdfstring{\ensuremath{\mathcal{L}_{\text{\textit{tac}}}}}{Ltac}}
\newcommand{\LtacTwo}{Ltac2}
\newcommand{\Mtac}{Mtac}
\newcommand{\MtacTwo}{Mtac2}
\newcommand{\Coq}{Coq}
\newcommand{\Agda}{Agda}
\newcommand{\Idris}{Idris}
\newcommand{\NuPRL}{NuPRL}
\newcommand{\Lean}{Lean}
\newcommand{\coqgroupb}[1]{\texttt{\ensuremath{\left(\text{#1}\right)}}}
\newcommand{\coqgroup}[1]{\texttt{(#1)}}
\newcommand{\functiondefeq}{~\ensuremath{\operatorname{\texttt{\ensuremath{\defeq}}}}~}

% highlight overfull hboxes
%\overfullrule=5pt


% http://tex.stackexchange.com/a/183682/2066
\makeatletter

% define a macro \Autoref to allow multiple references to be passed to \autoref
\newcommand\Autoref[1]{\@first@ref#1,@}
\def\@throw@dot#1.#2@{#1}% discard everything after the dot
\def\@set@refname#1{%    % set \@refname to autoefname+s using \getrefbykeydefault
    \edef\@tmp{\getrefbykeydefault{#1}{anchor}{}}%
    \def\@refname{\@nameuse{\expandafter\@throw@dot\@tmp.@autorefname}s}%
}
\def\@first@ref#1,#2{%
  \ifx#2@\autoref{#1}\let\@nextref\@gobble% only one ref, revert to normal \autoref
  \else%
    \@set@refname{#1}%  set \@refname to autoref name
    \@refname~\ref{#1}% add autoefname and first reference
    \let\@nextref\@next@ref% push processing to \@next@ref
  \fi%
  \@nextref#2%
}
\def\@next@ref#1,#2{%
   \ifx#2@ and~\ref{#1}\let\@nextref\@gobble% at end: print and+\ref and stop
   \else, \ref{#1}% print  ,+\ref and continue
   \fi%
   \@nextref#2%
}

\makeatother
\allowdisplaybreaks

% from reification-by-parametricity


% begin appendix autoref patch [\autoref subsections in appendix](https://tex.stackexchange.com/questions/149807/autoref-subsections-in-appendix)
\makeatletter
\patchcmd{\hyper@makecurrent}{%
    \ifx\Hy@param\Hy@chapterstring
    \let\Hy@param\Hy@chapapp
    \fi
}{%
\iftoggle{inappendix}{%true-branch
    % list the names of all sectioning counters here
    \@checkappendixparam{chapter}%
    \@checkappendixparam{section}%
    \@checkappendixparam{subsection}%
    \@checkappendixparam{subsubsection}%
    \@checkappendixparam{paragraph}%
    \@checkappendixparam{subparagraph}%
}{}%
}{}{\errmessage{failed to patch}}

\newcommand*{\@checkappendixparam}[1]{%
    \def\@checkappendixparamtmp{#1}%
    \ifx\Hy@param\@checkappendixparamtmp
    \let\Hy@param\Hy@appendixstring
    \fi
}
\makeatletter

\newtoggle{inappendix}
\togglefalse{inappendix}

\apptocmd{\appendix}{\toggletrue{inappendix}}{}{\errmessage{failed to patch}}
%\apptocmd{\subappendices}{\toggletrue{inappendix}}{}{\errmessage{failed to patch}}
% end appendix autoref patch


\newcommand{\letindots}{\texttt{let \ldots\space in \ldots}}
\newcommand{\letin}[1][{\ensuremath{\cdots}}{\ensuremath{\cdots}}]{%
    \texttt{let }\@firstoftwo#1\texttt{ in }\@secondoftwo#1
}


\newcommand{\ttifycoqdoc}[1]{%
\expandafter\let\csname old\string#1\endcsname#1%
\renewcommand{#1}[1]{{%
\let\textrm\texttt
\let\textsf\texttt
\let\textit\texttt
\let\textsl\texttt
\csname old\string#1\endcsname{##1}%
}}%
}

\ttifycoqdoc\coqdocvar
\ttifycoqdoc\coqdoccst
\ttifycoqdoc\coqdocind
\ttifycoqdoc\coqdocconstr
\ttifycoqdoc\coqdocmod
\ttifycoqdoc\coqdocax

\makeatletter
\renewenvironment{coqdoccode}{\tt\@vobeyspaces}{}
\makeatother

\newcommand{\coqinput}[1]{{%
\let\oldsubsection\subsection
\renewcommand{\section}[1]{\oldsubsection{##1 (\texttt{#1})} \label{sec:#1}}%
\renewcommand{\subsection}[1]{\subsubsection{##1} \hfill$\left.\right.$ \linebreak}%
\input{#1.tex}%
}}
\newcommand{\subcoqinput}[1]{{%
\renewcommand{\section}[1]{\subsubsection{##1 (\texttt{#1})} \label{sec:#1}\hfill$\left.\right.$ \linebreak}%
\renewcommand{\subsection}[1]{\paragraph{##1} \hfill$\left.\right.$ \linebreak}%
\input{#1.tex}%
}}
\newcommand{\ocamlinput}[2]{{%
\subsection{#1 (\texttt{\detokenize{#2}})} \label{sec:#2}
\verbatiminput{benchmark/#2}%
}}
\newcommand{\subocamlinput}[2]{{%
\subsubsection{#1 (\texttt{\detokenize{#2}})} \label{sec:#2}\hfill$\left.\right.$ \linebreak
\verbatiminput{benchmark/#2}%
}}

% https://tex.stackexchange.com/a/121871/2066
\newcommand*{\fullnameref}[1]{\hyperref[{#1}]{\autoref*{#1} (\nameref*{#1})}} % One single link
\newcommand*{\autocommanameref}[1]{\autoref{#1}, \nameref{#1}}

% https://groups.google.com/d/msg/latexusersgroup/07qZP63GY3k/cu53DqbAhkYJ
\makeatletter
% also use the \romannumeral-`\q trick from etextools to fully expand leading macros
\newcommand{\Chapter}[1]{\expandafter\split@chapter\romannumeral-`\q#1:}
\def\split@chapter#1:#2:{\chapter[#1]{#1\\[1ex]\huge#2}}
\makeatother



% from rewriting

\usepackage[shortlabels]{enumitem}% for deeply nested itemize lists from pandoc output
%\usepackage{usebib}
%\newbibfield{author}
%\newbibfield{title}
%\bibinput{rewriting-lower}
%\newcommand{\citetitle}[1]{\emph{\usebibentry{#1}{title}}\nocite{#1}}
\makeatletter
\newcommand{\einput}[1]{\@@input #1 \space}
\newcommand{\beginTikzpictureStamped}[2][]{%
    {%
        \everyeof{\noexpand}% IDK why \noexpand is the magic one, but I got it from http://mirrors.ibiblio.org/CTAN/macros/latex/contrib/oberdiek/catchfile.pdf
        \long\xdef\@tikzstamp{#2}%
    }%
    \def\@dobegintikzpicture{\begin{tikzpicture}[#1]}%
    \expandafter\@dobegintikzpicture\expandafter\def\expandafter\tikzstamp\expandafter{\@tikzstamp}%
}
\newcommand{\TikzpictureStamped}[3][]{\beginTikzpictureStamped[#1]{#2}#3\end{tikzpicture}}%
\makeatother
\newcommand{\asserteq}[2]{\ifthenelse{\equal{#1}{#2}}{}{\GenericError{}{Not equal: \detokenize{#1} != \detokenize{#2}}{}{}}}

%% from pandoc
\providecommand{\tightlist}{%
    \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}

\makeatletter
% https://tex.stackexchange.com/a/50113/2066
\newcommand*{\IsInteger}[3]{%
    \IfStrEq{#1}{ }{%
        #3% is a blank string
    }{%
    \IfInteger{#1}{#2}{#3}%
}%
}%
\makeatother


\makeatletter
% \addplotfunctionalregression{regression kind}{default settings for a and b, also for x and y columns}{default settings for table}{comma-separated-variable-list}{f(x)}{params for \addplot}{table file}
\newcounter{addplotfunctionalregression@var@count}
\newcommand{\addplotfunctionalregression@tablename}{\jobname-regression.table}
\newcommand{\addplotfunctionalregression@parametersname}{\jobname-parameters.dat}
\newif\iffunctionalregression@boundy
\newcommand{\addplotfunctionalregression}[7]{%
    \begingroup
    \pgfqkeys{/pgfplots/table/create col/#1 regression}{#2}%
    \pgfkeysgetvalue{/pgfplots/table/create col/#1 regression/x}{\pgfplotstable@xsrc}%
    \pgfkeysgetvalue{/pgfplots/table/create col/#1 regression/y}{\pgfplotstable@ysrc}%
%    \pgfkeysgetvalue{/pgfplots/table/create col/#1 regression/bound y}{\pgfplotstable@boundy}%
%    \csname functionalregression@boundy\pgfplotstable@boundy\endcsname
    \def\pgfplotstable@regression@initcode{}%
    \foreach \varname in {#4} {%
      \pgfkeysgetvalue{/pgfplots/table/create col/#1 regression/\varname}{\pgfplotstable@varinit}%
      \xdef\pgfplotstable@regression@initcode{%
        \pgfplotstable@regression@initcode\space
        \varname=\pgfplotstable@varinit;
      }%
    }%
    %\def\pgfplotstable@table{#7}%
    \pgfplotstableread[#3]{#7}{\pgfplotstable@tableinternal}% FIXME
    \def\pgfplotstable@table{\pgfplotstable@tableinternal}%
    \ifx\pgfplotstable@table\pgfutil@empty
          \pgfutil@ifundefined{pgfplotstablename}{}{% query the name of the actual table struct
                \let\pgfplotstable@table=\pgfplotstablename
          }%
    \fi
    \ifx\pgfplotstable@table\pgfutil@empty
          \pgfplots@error{Sorry, I couldn't determine a value for create col/#1 regression/table. Which table should I load?}%
    \fi
    \ifx\pgfplotstable@xsrc\pgfutil@empty
        \pgfplotsifinaddplottablestruct{%
          \pgfutil@ifundefined{pgfplots@plot@tbl@x}{}{%
            \let\pgfplotstable@xsrc=\pgfplots@plot@tbl@x
            \ifx\pgfplotstable@ysrc\pgfutil@empty
              \pgfplotstablegetcolsof\pgfplots@table
              \ifnum\pgfplotsretval=2
              \else
                \pgfplotsthrow{invalid argument}{\pgfplotstable@ysrc}{Sorry, I don't which column should be used as `y' for the #1 regression. Please provide '#1 regression={y=<colname>}'}\pgfeov%
              \fi
            \fi
          }%
        }{}%
    \fi
    \ifx\pgfplotstable@xsrc\pgfutil@empty
            \def\pgfplotstable@xsrc{[index]0}%
    \fi
    \ifx\pgfplotstable@ysrc\pgfutil@empty
            \def\pgfplotstable@ysrc{[index]1}%
    \fi
    \bgroup
      \edef\dosavetable{\noexpand\pgfplotstablesave[
          col sep=comma,
          columns={\pgfplotstable@xsrc,\pgfplotstable@ysrc},
        ]{\expandafter\unexpanded\expandafter{\pgfplotstable@table}}{\addplotfunctionalregression@tablename}%
      }%
      \dosavetable
      \everyeof{\noexpand}%
      \def\par{^^J}%
      \obeylines
      \makeatletter
      \xdef\pgfplotstable@gnu@table{\@@input \addplotfunctionalregression@tablename\space}%
    \egroup
    \xdef\pgfplotstable@gnu@code{%
        f(x) = #5;     % Define the function to fit
        % Set reasonable starting values here
        \pgfplotstable@regression@initcode\space
        set datafile separator ",";
        $Mydata << EOD^^J%
        \pgfplotstable@gnu@table^^J%
        EOD^^J
        fit f(x) $Mydata u 1:2 via #4; % Select the file
        stats $Mydata u 1:2;
        plot [x=STATS_min_x:STATS_max_x]\iffunctionalregression@boundy[STATS_min_y:STATS_max_y]\fi f(x);    % Specify the range to plot
        set print "\addplotfunctionalregression@parametersname";  % Open a file to save the parameters
        print #4;                  % Write the parameters to file
    }%
    \addplot [#6] gnuplot [raw gnuplot] {\pgfplotstable@gnu@code}; % allows arbitrary gnuplot commands
    \pgfplotstableread{\addplotfunctionalregression@parametersname}\parameters % Open the file Gnuplot wrote
    \setcounter{addplotfunctionalregression@var@count}{0}%
    \foreach \varname in {#4} {%
      \pgfplotstablegetelem{0}{\arabic{addplotfunctionalregression@var@count}}\of\parameters
      \expandafter\xdef\csname pgfplotstableregression\varname\endcsname{\pgfplotsretval}
      \stepcounter{addplotfunctionalregression@var@count}%
    }%
    \endgroup
}
% \addplot<kind>regression[params for \addplot][default settings for a and b, also for x and y columns][table parameters]{table file}
% \pgfplotstablenewregression{regression name}{comma-separated variable list}{function}
\newcommand{\pgfplotstablenewregression}[3]{%
  \expandafter\NewDocumentCommand\csname addplot#1regression\endcsname{ O{no markers} O{} O{} m}{%
      \addplotfunctionalregression{#1}%
          {##2}%
          {##3}%
          {#2}%
          {#3}%
          {##1}%
          {##4}%
  }
  \pgfkeys{%
%        /pgfplots/table/create col/#1 regression/.code={%
%                \pgfplotstable@#1@regression{#1}%
%                \pgfkeysalso{/pgfplots/table/create col/@from list struct=\pgfplotsretval}%
%        },
        /pgfplots/table/create col/#1 regression/.default=,%
        /pgfplots/table/create col/#1 regression/x/.initial=,%
        /pgfplots/table/create col/#1 regression/y/.initial=,%
        /pgfplots/table/create col/#1 regression/bound y/.is if=functionalregression@boundy,
        /pgfplots/table/create col/#1 regression/table/.initial=,%
        %/pgfplots/table/create col/#1 regression/variance/.initial=,%
        %/pgfplots/table/create col/#1 regression/variance list/.initial=,%
        %/pgfplots/table/create col/#1 regression/variance src/.initial=,%
        %/pgfplots/table/create col/#1 regression/xmode/.initial=,% auto
        %/pgfplots/table/create col/#1 regression/ymode/.initial=,% auto
  }
  \bgroup % cf https://tex.stackexchange.com/a/15263/2066
    \globaldefs=1\relax
    \foreach \varname in {#2} {%
      \pgfkeys{%
        /pgfplots/table/create col/#1 regression/\varname/.initial=1,%
      }%
    }
  \egroup
}


%% exponential regression fit
% \addplotexponentialregression[params for \addplot][default settings for a and b, also for x and y columns][table parameters]{table file}
\pgfplotstablenewregression{exponential}{a,b}{a*exp(b*x)}
% \addplotquadraticregression[params for \addplot][default settings for a and b and c, also for x and y columns][table parameters]{table file}
\pgfplotstablenewregression{quadratic}{a,b,c}{a*x**2+b*x+c}
% \addplotcubicregression[params for \addplot][default settings for a and b and c and d, also for x and y columns][table parameters]{table file}
\pgfplotstablenewregression{cubic}{a,b,c,d}{a*x**3+b*x**2+c*x+d}
% regress on y = a (x!)
% \addplotfactorialregression[params for \addplot][default settings for a, also for x and y columns][table parameters]{table file}
\pgfplotstablenewregression{factorial}{a}{a*gamma(x+1)}
\makeatother

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% from category-coq-experience
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\makeatletter
\newlength{\assizeof@height}
\newlength{\assizeof@depth}
\newlength{\assizeof@width}
\newcommand{\asheightof}[2]{%
    \settoheight{\assizeof@height}{#2}%
    \settowidth{\assizeof@width}{#2}%
    \settodepth{\assizeof@depth}{#2}%
    \raisebox{0pt}[\assizeof@height][\assizeof@depth]{#1}%
}
\newsavebox{\checkmarkdashed@box}
\sbox{\checkmarkdashed@box}{%
    \tikzexternaldisable
    \begin{tikzpicture}[scale=0.0018, x=\baselineskip, y=-\baselineskip]
    %[y=0.80pt,x=0.80pt,yscale=-1, inner sep=0pt, outer sep=0pt]
    \begin{scope}[shift={(-76.14285,-468.51261)}]
    \path[fill=gray] (346.8401,509.3677) .. controls (340.5769,505.0388) and
    (340.7618,500.5122) .. (356.8188,488.4276) .. controls (372.8758,476.3431) and
    (385.5965,469.4556) .. (393.7791,468.6693) .. controls (402.4251,467.8385) and
    (404.1912,473.2846) .. (397.5467,480.2873) .. controls (395.7973,482.1311) and
    (389.1909,487.6189) .. (382.8659,492.4825) .. controls (374.6709,499.4135) and
    (356.1486,515.8013) .. (346.8401,509.3677) -- cycle;
    \path[fill=gray] (260.1089,583.4074) .. controls (266.3140,575.7764) and
    (272.7509,568.2670) .. (279.3743,560.8342) .. controls (324.4398,518.7462) and
    (319.3756,546.8324) .. (289.7561,585.4171) .. controls (282.4707,594.9346) and
    (276.2845,605.1740) .. (270.0874,615.4138) .. controls (215.7257,693.3061) and
    (215.7106,638.2351) .. (260.1089,583.4074) -- cycle;
    \path[fill=gray] (184.4815,709.4074) .. controls (188.7556,700.1304) and
    (193.0479,690.9313) .. (196.6062,682.0703) .. controls (214.1074,660.9549) and
    (227.6958,691.0301) .. (219.6701,711.9379) .. controls (210.8162,735.0030) and
    (203.2310,759.0839) .. (197.0533,784.3044) .. controls (172.5104,824.2648) and
    (170.7368,739.2609) .. (184.4815,709.4074) -- cycle;
    \path[fill=gray] (121.6449,767.9646) .. controls (118.8624,763.3407) and
    (98.3906,735.2020) .. (96.1182,731.3920) .. controls (91.5735,723.7721) and
    (88.0116,717.7146) .. (85.2823,712.9577) .. controls (79.8236,703.4439) and
    (77.6952,699.1324) .. (77.6952,697.9285) .. controls (77.6952,691.5044) and
    (92.7170,679.4441) .. (106.4137,674.8717) .. controls (114.2814,672.2452) and
    (115.9904,672.2686) .. (119.1161,675.0458) .. controls (120.5090,676.2833) and
    (141.7234,710.5494) .. (153.0933,729.2494) .. controls (155.8390,738.5209) and
    (141.8256,804.9784) .. (121.6449,767.9646) -- cycle;
    \end{scope}
    \end{tikzpicture}%
    \tikzexternalenable
}

\newcommand{\checkmarkdashed}{\asheightof{\usebox{\checkmarkdashed@box}}{\checkmark}}
\makeatother
% \cat{C} is the style for a category C
\newcommand{\maybemathcal}[1]{\ifx\mathcal#1\relax\expandafter\mathcal\else\mathcal{#1}\fi}
\newcommand{\cat}[1]{\ensuremath{\maybemathcal #1}}
\newcommand{\maybesub}[1][]{\ifthenelse{\equal{#1}{}}{}{\ensuremath{_{#1}}}}
\newcommand{\maybecat}[1][]{\ifthenelse{\equal{#1}{}}{}{\ensuremath{_{\cat{#1}}}}}
\newcommand{\Ob}[1][]{\ensuretext{Ob}\maybecat[#1]}
\newcommand{\Hom}[1][]{\ensuretext{Hom}\maybecat[#1]}
\newcommand{\Id}[1][]{\ensuremath{1}\maybesub[#1]}
\newcommand{\term}[1]{\ensuretexttt{#1}}
\newcommand{\mailto}[1]{\href{mailto:#1}{#1}}

\newcommand{\pullbacksymbol}{{\ensuremath{\lrcorner}}}
\newcommand{\pullbackarrow}[1][dr]{\ar@{}[#1]|<<\pullbacksymbol}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


%%%%%%%%%%%%%%%%%%%% forms %%%%%%%%%%%%%%%%%%%%

%\def\signature#1#2{\par\noindent#1\dotfill\null\\*
%  {\raggedleft #2\par}}
\makeatletter
\providecommand{\signature}{}
\renewcommand{\signature}[2]{\par\noindent#1%
  {\def\\{}%
   \xdef\sigature@descr{#2}%
  }%
  \rlap{\raisebox{0pt}[0pt][0pt]{\sigField{\sigature@descr}{\textwidth-\widthof{#1}}{3\baselineskip}}}%
  \dotfill\null\\*
  {\raggedleft #2\par}%
}
\makeatother

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% According to https://libraries.mit.edu/distinctive-collections/thesis-specs/,
% Abstracts should be no longer than 350 words, longer abstracts will be edited by ProQuest

\def\maxabstractwordcount{350}

\begingroup
\lccode`\~=`\ %
\lowercase{%
  \gdef\wordcounting{\setcounter{word}{0}%
    \catcode`~=\active
    \def~{\space\stepcounter{word}}}}%
\endgroup
\newcounter{word}
\appto{\abstract}{\bgroup\wordcounting}
\preto{\endabstract}{\stepcounter{word}%
  \xdef\abstractwordcount{\arabic{word}}\egroup%
  \ifthenelse{\abstractwordcount>\maxabstractwordcount}{%
    \etodo{Shorten the abstract; currently using about \abstractwordcount\space words of \maxabstractwordcount}%
  }{}%
}


% [before-text][after-text][# characters in commit to use (negative for all)]{user/repo}{commit sha}
\newcommand{\maybeshortsha}[2]{%
  \ifthenelse{#1 < 0}{%
    #2%
  }{%
    \StrLeft{#2}{#1}%
  }%
}
\newcommandx{\githubref}[5][1=,2=,3=7]{\href{https://github.com/#4/commit/#5}{#1{\maybeshortsha{#3}{#5}}#2}}

\input{todo}

%%%% spellchecking
\input{spellcheck-results}
\edef\spellchecktodo{\noexpand\todo{Spellcheck the following words: \spellcheckresults}}
\ifthenelse{\equal{\spellcheckresults}{}}{
}{
  \AtBeginDocument{\spellchecktodo}
}
