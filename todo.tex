\makeatletter
\iffinal
\let\finalwarning=\errmessage
\else
\let\finalwarning=\@latex@warning
\fi
\ifx\@onlypreamble\@notprerr% (document)
\newcommand{\NowOrAtBeginDocument}[1]{#1}%
\else% (preamble)
\newcommand{\NowOrAtBeginDocument}[1]{\AtBeginDocument{#1}}%
\AtBeginDocument{\renewcommand{\NowOrAtBeginDocument}[1]{#1}}%
\fi
\newcommand{\todo}[1]{%
\finalwarning{TODO: \detokenize{#1}}%
\NowOrAtBeginDocument{\textcolor{red}{[\textbf{TODO:} #1]}}}%
\newcommand{\todoask}[1]{%
\finalwarning{QUESTION FOR ADAM: \detokenize{#1}}%
\NowOrAtBeginDocument{\textcolor{purple}{[\textbf{QUESTION FOR ADAM:} #1]}}}%
\newcommand{\colorifzero}[3]{%
\ifnum#1=0\relax
\expandafter\@firstoftwo
\else
\expandafter\@secondoftwo
\fi
{\textcolor{#2}{#3}}%
{#3}%
}%
\makeatother
\newcommand{\editedtext}[2][0]{\colorifzero{#1}{blue}{#2}}%
\newcommand{\newtext}[2][0]{\colorifzero{#1}{blue}{#2}}%
\iffinal
\else
\NowOrAtBeginDocument{%
\pagenumbering{roman}

\todo{Run `make update-thesis' before submission to update the date on the cover page}

\todo{change \string\finalfalse to \string\finaltrue}

\cleardoublepage
\pagenumbering{arabic}
}%
\fi
